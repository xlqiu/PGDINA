% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/structuralparm.R
\name{structural.parm}
\alias{structural.parm}
\title{Update structural parameters of the attribute distribution (internal)}
\usage{
structural.parm(
  AlphaPattern,
  no.mg,
  logprior,
  att.dist,
  att.str,
  saturated,
  initial.logprior,
  lower.prior,
  loglinear = 2,
  N,
  Ng,
  K,
  lambda,
  higher.order
)
}
\arguments{
\item{AlphaPattern}{A binary matrix of all attribute patterns, of size \eqn{2^K \times K}.}

\item{no.mg}{Integer; number of groups \eqn{G}.}

\item{logprior}{A matrix of log prior probabilities of size \eqn{2^K \times G}.}

\item{att.dist}{Character vector of length 1 or \eqn{G} specifying the attribute distribution
model per group. Values used include \code{"saturated"}, \code{"loglinear"},
\code{"independent"}, \code{"fixed"}, and \code{"higher.order"}.}

\item{att.str}{Logical; whether an attribute structure is imposed. When \code{TRUE},
only \code{att.dist = "saturated"} or \code{"fixed"} is allowed in this implementation.}

\item{saturated}{A list containing saturated prior information. Must include
\code{saturated$prior}, expected to be a vector or matrix of size \eqn{2^K \times G}
used as pseudo-count prior (NEED TO UPDATE).}

\item{initial.logprior}{A matrix of initial log prior probabilities of size \eqn{2^K \times G}.
Used when \code{att.dist = "fixed"}.}

\item{lower.prior}{Numeric scalar or length-\eqn{G} vector giving the minimum allowed class prior
probability (applied per group, then renormalized).}

\item{loglinear}{Integer scalar or length-\eqn{G} vector specifying maximum interaction order for
\code{att.dist = "loglinear"}. Default is 2.}

\item{N}{Integer; total sample size (used in loglinear smoothing as \code{log(N * prior)}).}

\item{Ng}{Integer vector of length \eqn{G}; group sample sizes.}

\item{K}{Integer; number of attributes.}

\item{lambda}{List (length \eqn{G}) of current structural parameters; updated and returned.
For example, it stores class priors for \code{"saturated"}, coefficients for \code{"loglinear"},
marginal mastery probabilities for \code{"independent"}, or higher-order parameters
when \code{"higher.order"} (NEED TO UPDATE).}

\item{higher.order}{List of higher-order model settings passed to \code{HO.est()} when
\code{att.dist = "higher.order"} (NEED TO UPDATE structure).}
}
\value{
A list with components:
\itemize{
\item \code{logprior}: Updated log prior matrix of size \eqn{2^K \times G}.
\item \code{lambda}: Updated structural parameter list (length \eqn{G}).
\item \code{higher.order}: Updated higher-order settings (or \code{NULL}).
\item \code{higher.order.npar}: Number of higher-order parameters (NEED TO UPDATE; \code{NA} if not applicable).
}
}
\description{
Internal helper called in the M-step to update the joint attribute (latent class)
distribution under different assumptions. Supported attribute distribution models
include saturated, loglinear smoothing, independent, fixed, and higher-order
(delegated to \code{HO.est()}).
}
\examples{
\dontrun{
# Internal function called during EM updates.
}

}
\seealso{
\code{\link{Est.inOptim}}
}
\keyword{internal}
