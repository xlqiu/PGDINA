% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Est.Optim.R
\name{Est.inOptim}
\alias{Est.inOptim}
\title{Estimate item parameters and structural parameters via EM (internal optimizer)}
\usage{
Est.inOptim(
  dat,
  Q,
  model,
  sequential,
  att.dist,
  att.prior,
  saturated,
  att.str,
  mono.constraint,
  group,
  latent.var,
  verbose,
  catprob.parm,
  loglinear,
  item.names,
  solnp_args,
  item.prior,
  linkfunc,
  higher.order,
  solver,
  auglag_args,
  nloptr_args,
  DesignMatrices,
  ConstrPairs,
  control
)
}
\arguments{
\item{dat}{Response data matrix of size \eqn{N \times J} (persons \eqn{N} by items \eqn{J}).
For dichotomous items values are typically 0/1; missing values are allowed.
If \code{sequential = TRUE}, data may originate from polytomous items and are
sequentially recoded internally (NEED TO UPDATE).}

\item{Q}{Q-matrix. Typically a binary matrix of size \eqn{J \times K} (items \eqn{J} by attributes \eqn{K}).
If \code{sequential = TRUE} or if MSDINA items are included, \code{Q} may contain
extra columns for item/category indexing (e.g., first two columns) (NEED TO UPDATE).}

\item{model}{Item model specification. A length-\eqn{J} vector (or scalar recycled) that is transformed
by \code{model.transform()}. Encodings used in this function correspond to
\code{"logGDINA","logitGDINA","UDF","GDINA","DINA","DINO","ACDM","LLM","RRUM","MSDINA"} (NEED TO UPDATE).}

\item{sequential}{Logical; whether to fit a sequential model (polytomous items recoded via \code{seq_coding}).}

\item{att.dist}{Character scalar or length-\eqn{G} vector specifying the attribute distribution model per group.
Values used include \code{"saturated"}, \code{"loglinear"}, \code{"independent"}, \code{"fixed"},
and \code{"higher.order"} (NEED TO UPDATE supported set).}

\item{att.prior}{Prior for the joint attribute distribution. If \code{NULL}, initialized to uniform.
If provided, should be a vector of length \eqn{2^K} or a matrix of size \eqn{2^K \times G},
where \eqn{G} is number of groups.}

\item{saturated}{A list containing information for saturated attribute distribution updates.
Must include \code{saturated$prior}, expected to be a vector or a matrix of size \eqn{2^K \times G}
used as pseudo-count prior (NEED TO UPDATE).}

\item{att.str}{Logical; whether an attribute structure is imposed. When \code{TRUE}, only DINA/DINO/GDINA
models are allowed and monotonicity constraints are disabled in this implementation.}

\item{mono.constraint}{Logical or logical vector of length \eqn{J}; whether to impose monotonicity constraints per item.}

\item{group}{Optional integer vector of length \eqn{N} indicating group membership (must start at 1).
If \code{NULL}, a single group is assumed.}

\item{latent.var}{Logical; whether latent variance is modeled/used in initialization (NEED TO UPDATE).}

\item{verbose}{Integer; printing level. \code{0} silent, \code{1} progress in-place, \code{2} print each iteration.}

\item{catprob.parm}{Optional initial item parameters. If \code{NULL}, generated by \code{initials()}.
If provided, converted by \code{l2m()} to a matrix (NEED TO UPDATE expected shape).}

\item{loglinear}{Integer scalar or length-\eqn{G} vector giving maximum interaction order used when
\code{att.dist = "loglinear"}.}

\item{item.names}{Optional character vector of length \eqn{J} giving item labels. If \code{NULL}, default names are created.}

\item{solnp_args}{List of arguments passed to \code{solnp} (package \pkg{Rsolnp}) when used as optimizer (NEED TO UPDATE).}

\item{item.prior}{Optional item-parameter prior information passed to \code{MstepinOptim} (NEED TO UPDATE).}

\item{linkfunc}{Link function for delta parameterization. Can be \code{"identity"}, \code{"logit"}, or \code{"log"},
either scalar or length-\eqn{J} vector; internally mapped to 1/2/3.}

\item{higher.order}{List of settings for higher-order model estimation when \code{att.dist = "higher.order"}.
Contains quadrature nodes/weights and other options (NEED TO UPDATE full structure).}

\item{solver}{Character scalar or length-\eqn{J} vector specifying the optimizer per item (default \code{"auto"})
(NEED TO UPDATE supported values).}

\item{auglag_args}{List of control arguments for augmented Lagrangian optimization (NEED TO UPDATE).}

\item{nloptr_args}{List of control arguments passed to \pkg{nloptr} (NEED TO UPDATE).}

\item{DesignMatrices}{Optional list of design matrices, length \eqn{J}. If \code{model} includes user-defined items,
design matrices must be provided (NEED TO UPDATE exact requirements).}

\item{ConstrPairs}{Optional list (length \eqn{J}) defining partial orders used for monotonicity constraints
(NEED TO UPDATE).}

\item{control}{A list of EM/optimization control parameters. Defaults include:
\code{maxitr}, \code{conv.crit}, \code{conv.type}, \code{nstarts}, \code{lower.p}, \code{upper.p},
\code{lower.prior}, and \code{randomseed}.}
}
\value{
A list containing estimated parameters and diagnostics, including:
\itemize{
\item \code{catprob.parm}: list of item category probabilities, length \eqn{J}.
\item \code{delta.parm}: list of delta parameters per item.
\item \code{catprob.matrix}: item parameter matrix.
\item \code{struc.parm}: structural parameters (\code{lambda}) for attribute distribution.
\item \code{model}: item model names.
\item \code{LC.prob}: latent class probabilities (possibly transformed for sequential items).
\item \code{posterior.prob}: posterior class probabilities (by group if applicable).
\item \code{testfit}: deviance and information criteria (AIC/BIC) with parameter counts.
\item \code{technicals}: internal quantities from E/M steps.
\item \code{options}: inputs and settings used for estimation.
\item \code{control}: final control list.
}
}
\description{
Internal function used in the PGDINA/GDINA-family fitting procedure. It runs an
EM algorithm to estimate item response probabilities (and/or delta parameters)
together with the latent class / attribute distribution under different
attribute distribution assumptions (e.g., saturated, loglinear, independent,
higher-order), optionally with monotonicity constraints and multiple optimizers.
}
\examples{
\dontrun{
# This is an internal function called by higher-level model fitting routines.
# Users typically call a wrapper such as PGDINA(...) / GDINA(...), not Est.inOptim() directly.
}

}
\seealso{
\code{\link{structural.parm}}
}
\keyword{internal}
